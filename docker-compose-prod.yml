networks:
    modx-pd-site-network:
        driver: bridge
        name: modx-pd-site-network

services:
    db_modx:
        container_name: db_modx
        image: mysql:5.6
        restart: always
        ports:
            - "3306:3306"
        environment:
            MYSQL_ROOT_PASSWORD: ${DB_PASSWORD}
            MYSQL_DATABASE: ${DB_NAME}
            MYSQL_USER: ${DB_USER}
            MYSQL_PASSWORD: ${DB_PASSWORD}
        networks:
            - modx-pd-site-network
        working_dir: /var/www/modx
        volumes:
          - ./docker/mysql/volume:/var/lib/mysql
          - ./modx.sql:/var/www/modx/modx.sql
        command: ['mysqld', '--character-set-server=utf8mb4', '--collation-server=utf8mb4_general_ci']

    phpmyadmin:
        depends_on:
          - db_modx
        image: phpmyadmin
        restart: always
        ports:
          - "8090:80"
        environment:
          PMA_HOST: db_modx
          PMA_USER: root
          PMA_PASSWORD: 'modx_pass'
          PMA_PORT: 3306
        networks:
          - modx-pd-site-network